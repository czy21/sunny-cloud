["clean", "build"].forEach { t ->
    tasks.register("${t}") {
        gradle.getIncludedBuilds().each {
            if (file("${it.name}/${it.name}-portal").exists()) {
                dependsOn gradle.includedBuild("${it.name}").task(":${it.name}-portal:${t}")
            } else {
                dependsOn gradle.includedBuild("${it.name}").task(":${t}")
            }
        }
    }
}