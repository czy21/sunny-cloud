

def compose = (action) -> {
    rootDir.eachDir {
        if (file("${it.name}/settings.gradle").exists() && file("${it.name}/${it.name}-portal").exists()) {
            dependsOn gradle.includedBuild("${it.name}").task(":${it.name}-portal:${action}")
        }
    }
    dependsOn gradle.includedBuild("sunny-gateway").task(":${action}")
}

tasks.register('build') {
    compose("build")
}
